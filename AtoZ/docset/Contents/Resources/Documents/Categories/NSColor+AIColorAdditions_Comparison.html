<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="html/html; charset=utf-8" />
		<title>NSColor(AIColorAdditions_Comparison) Category Reference</title>
		<meta id="xcode-display" name="xcode-display" content="render"/>
		<meta name="viewport" content="width=550" />
		<link rel="stylesheet" type="text/css" href="../css/styles.css" media="all" />
		<link rel="stylesheet" type="text/css" media="print" href="../css/stylesPrint.css" />
		<meta name="generator" content="appledoc 2.0.5 (build 789)" />
	</head>
	<body>
		<header id="top_header">
			<div id="library" class="hideInXcode">
				<h1><a id="libraryTitle" href="../index.html">AtoZ.Framework </a></h1>
				<a id="developerHome" href="../index.html">mrgray.com</a>
			</div>
			
			<div id="title" role="banner">
				<h1 class="hideInXcode">NSColor(AIColorAdditions_Comparison) Category Reference</h1>
			</div>
			<ul id="headerButtons" role="toolbar">
				<li id="toc_button">
					<button aria-label="Show Table of Contents" role="checkbox" class="open" id="table_of_contents"><span class="disclosure"></span>Table of Contents</button>
				</li>
				<li id="jumpto_button" role="navigation">
					<select id="jumpTo">
	<option value="top">Jump To&#133;</option>
	
	<option value="overview">Overview</option>
	
	
	
	
	
	
	
	
	
	
	
	
	
</select>
				</li>
			</ul>
		</header>
		<nav id="tocContainer" class="isShowingTOC">
			<ul id="toc" role="tree">
				
<li role="treeitem"><span class="nodisclosure"></span><span class="sectionName"><a href="#overview">Overview</a></span></li>













			</ul>
		</nav>
		<article>
			<div id="contents" class="isShowingTOC" role="main">
				<a title="NSColor(AIColorAdditions_Comparison) Category Reference" name="top"></a>
				<div class="main-navigation navigation-top">
					<ul>
	<li><a href="../index.html">Index</a></li>
	<li><a href="../hierarchy.html">Hierarchy</a></li>
</ul>
				</div>
				<div id="header">
					<div class="section-header">
						<h1 class="title title-header">NSColor(AIColorAdditions_Comparison) Category Reference</h1>
					</div>		
				</div>
				<div id="container">	
					
					<div class="section section-specification"><table cellspacing="0"><tbody>
						<tr>
	<td class="specification-title">Declared in</td>
	<td class="specification-value">NSColor+AtoZ.m</td>
</tr>
						</tbody></table></div>
					
					
					
					
					<div class="section section-overview">
						<a title="Overview" name="overview"></a>
						<h2 class="subtitle subtitle-overview">Overview</h2>
						<ul>
<li>(id)dictionaryWithContentsOfRGBTxtFile:(NSString <em>)path
{
NSMutableData </em>data = [NSMutableData dataWithContentsOfFile:path];
if (!data) return nil;</li>
</ul>


<p>char <em>ch = [data mutableBytes]; //we use mutable bytes because we want to tokenise the string by replacing separators with &lsquo;\0&rsquo;.
NSUInteger length = [data length];
struct {
const char </em>redStart, <em>greenStart, </em>blueStart, <em>nameStart;
const char </em>redEnd,   <em>greenEnd,   </em>blueEnd;
float red, green, blue;
unsigned reserved: 23;
unsigned inComment: 1;
char prevChar;
} state = {
.prevChar = &lsquo;\n&rsquo;,
.redStart = NULL, .greenStart = NULL, .blueStart = NULL, .nameStart = NULL,
.inComment = NO,
};</p>

<p>NSDictionary *result = nil;</p>

<p>//the rgb.txt file that comes with Mac OS X 10.3.8 contains 752 entries.
//we create 3 autoreleased objects for each one.
//best to not pollute our caller&rsquo;s autorelease pool.</p>

<p>NSMutableDictionary *mutableDict = [NSMutableDictionary dictionary];</p>

<p>for (unsigned i = 0; i &lt; length; ++i) {
if (state.inComment) {
if (ch[i] == &lsquo;\n&rsquo;) state.inComment = NO;
} else if (ch[i] == &lsquo;\n&rsquo;) {
if (state.prevChar != &lsquo;\n&rsquo;) { //ignore blank lines
if (    ! ((state.redStart   != NULL)
&amp;&amp; (state.greenStart != NULL)
&amp;&amp; (state.blueStart  != NULL)
&amp;&amp; (state.nameStart  != NULL)))
{</p>

<h1>if COLOR_DEBUG</h1>

<p>NSLog(@&ldquo;Parse error reading rgb.txt file: a non-comment line was encountered that did not have all four of red (%p), green (%p), blue (%p), and name (%p) &ndash; index is %u&rdquo;,
state.redStart,
state.greenStart,
state.blueStart,
state.nameStart, i);</p>

<h1>endif</h1>

<p>goto end;
}</p>

<p>NSRange range = {
.location = state.nameStart &ndash; ch,
.length   = (&amp;ch[i]) &ndash; state.nameStart,
};
NSString <em>name = [NSString stringWithData:[data subdataWithRange:range] encoding:NSUTF8StringEncoding];
NSColor </em>color = [NSColor colorWithCalibratedRed:state.red
green:state.green
blue:state.blue
alpha:1.0f];
[mutableDict setObject:color forKey:name];
NSString *lowercaseName = [name lowercaseString];
if (![mutableDict objectForKey:lowercaseName]) {
//only add the lowercase version if it isn&rsquo;t already defined
[mutableDict setObject:color forKey:lowercaseName];
}</p>

<p>state.redStart = state.greenStart = state.blueStart = state.nameStart =
state.redEnd   = state.greenEnd   = state.blueEnd   = NULL;
} //if (prevChar != &lsquo;\n&rsquo;)
} else if ((ch[i] != &lsquo; &rsquo;) &amp;&amp; (ch[i] != &lsquo;\t&rsquo;)) {
if (state.prevChar == &lsquo;\n&rsquo; &amp;&amp; ch[i] == &lsquo;#&rsquo;) {
state.inComment = YES;
} else {
if (!state.redStart) {
state.redStart = &amp;ch[i];
state.red = (float)(strtod(state.redStart, (char <strong>)&amp;state.redEnd) / 255.0f);
} else if ((!state.greenStart) &amp;&amp; state.redEnd &amp;&amp; (&amp;ch[i] >= state.redEnd)) {
state.greenStart = &amp;ch[i];
state.green = (float)(strtod(state.greenStart, (char </strong>)&amp;state.greenEnd) / 255.0f);
} else if ((!state.blueStart) &amp;&amp; state.greenEnd &amp;&amp; (&amp;ch[i] >= state.greenEnd)) {
state.blueStart = &amp;ch[i];
state.blue = (float)(strtod(state.blueStart, (char **)&amp;state.blueEnd) / 255.0f);
} else if ((!state.nameStart) &amp;&amp; state.blueEnd &amp;&amp; (&amp;ch[i] >= state.blueEnd)) {
state.nameStart  = &amp;ch[i];
}
}
}
state.prevChar = ch[i];
} //for (unsigned i = 0; i &lt; length; ++i)</p>

<p>//why not use -copy? because this is subclass-friendly.
//you can call this method on NSMutableDictionary and get a mutable dictionary back.
result = [[self alloc] initWithDictionary:mutableDict];
end:</p>

<p>return result;
}</p>
					</div>
					
					
					
					
					
					
					
					
					
					
					
					
					
					
				</div>
				<div class="main-navigation navigation-bottom">
					<ul>
	<li><a href="../index.html">Index</a></li>
	<li><a href="../hierarchy.html">Hierarchy</a></li>
</ul>
				</div>
				<div id="footer">
					<hr />
					<div class="footer-copyright">
						<p><span class="copyright">&copy; 2012 mrgray.com. All rights reserved. (Last updated: 2012-09-15)</span><br />
						
						<span class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.0.5 (build 789)</a>.</span></p>
						
					</div>
				</div>
			</div>
		</article>
		<script type="text/javascript">
			function jumpToChange()
			{
				window.location.hash = this.options[this.selectedIndex].value;
			}
			
			function toggleTOC()
			{
				var contents = document.getElementById('contents');
				var tocContainer = document.getElementById('tocContainer');
				
				if (this.getAttribute('class') == 'open')
				{
					this.setAttribute('class', '');
					contents.setAttribute('class', '');
					tocContainer.setAttribute('class', '');
					
					window.name = "hideTOC";
				}
				else
				{
					this.setAttribute('class', 'open');
					contents.setAttribute('class', 'isShowingTOC');
					tocContainer.setAttribute('class', 'isShowingTOC');
					
					window.name = "";
				}
				return false;
			}
			
			function toggleTOCEntryChildren(e)
			{
				e.stopPropagation();
				var currentClass = this.getAttribute('class');
				if (currentClass == 'children') {
					this.setAttribute('class', 'children open');
				}
				else if (currentClass == 'children open') {
					this.setAttribute('class', 'children');
				}
				return false;
			}
			
			function tocEntryClick(e)
			{
				e.stopPropagation();
				return true;
			}
			
			function init()
			{
				var selectElement = document.getElementById('jumpTo');
				selectElement.addEventListener('change', jumpToChange, false);
				
				var tocButton = document.getElementById('table_of_contents');
				tocButton.addEventListener('click', toggleTOC, false);
				
				var taskTreeItem = document.getElementById('task_treeitem');
				if (taskTreeItem.getElementsByTagName('li').length > 0)
				{
					taskTreeItem.setAttribute('class', 'children');
					taskTreeItem.firstChild.setAttribute('class', 'disclosure');
				}
				
				var tocList = document.getElementById('toc');
				
				var tocEntries = tocList.getElementsByTagName('li');
				for (var i = 0; i < tocEntries.length; i++) {
					tocEntries[i].addEventListener('click', toggleTOCEntryChildren, false);
				}
				
				var tocLinks = tocList.getElementsByTagName('a');
				for (var i = 0; i < tocLinks.length; i++) {
					tocLinks[i].addEventListener('click', tocEntryClick, false);
				}
				
				if (window.name == "hideTOC") {
					toggleTOC.call(tocButton);
				}
			}
			
			window.onload = init;
		</script>
	</body>
</html>